<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>全部分类</title>
    <meta content="width=device-width,target-densitydpi=device-dpi, user-scalable=0" name="viewport">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta content="true" name="HandheldFriendly">
    <meta content="yes" name="apple-touch-fullscreen">
    <link href="css/style.css" rel="stylesheet">
    <meta content="模型APP内测招募" property="title"/>
    <meta content="最强最走心的模型APP登场！去模型圈大佬面对面交流，晒单拍卖无缝连接。" property="description"/>
    <meta content="最强最走心的模型APP登场！去模型圈大佬面对面交流，晒单拍卖无缝连接。" property="keywords"/>
    <meta content="https://www.2501p.com/img/share_logo.jpg" property="image"/>

    <meta content="模型APP内测招募" property="og:title"/>
    <meta content="最强最走心的模型APP登场！去模型圈大佬面对面交流，晒单拍卖无缝连接。" property="og:description"/>
    <meta content="最强最走心的模型APP登场！去模型圈大佬面对面交流，晒单拍卖无缝连接。" property="og:keywords"/>
    <meta content="https://www.2501p.com/img/share_logo.jpg" property="og:image"/>
    <script type="text/javascript">
        if (/Android (\d+\.\d+)/.test(navigator.userAgent)) {
            let version = parseFloat(RegExp.$1);
            if (version > 2.3) {
                let phoneScale = window.screen.width / 750;
                document.write('<meta name="viewport" content="width=750, minimum-scale = ' + phoneScale + ', maximum-scale = ' + phoneScale + ', target-densitydpi=device-dpi">');
            } else {
                document.write('<meta name="viewport" content="width=, target-densitydpi=device-dpi">');
            }
        } else {
            document.write('<meta name="viewport" content="width=750, user-scalable=no">');
        }
    </script>
    <script src="js/jquery-3.4.1.min.js" type="text/javascript"></script>
</head>
<body>
<div id="sify">
    <div id="head">
        <div class="search_box" style="width: 538px;margin-right:25px;">
            <div class="search_ico"></div>
            <input class="search_input" placeholder="搜索需要的商品" style="width:400px" type="text"/>
        </div>
        <div class="screenbt" onclick="$('#screen_box').fadeIn(200);" style="margin-right:25px;"></div>
        <a class="ico" href="myAuction.html"></a>
    </div>


    <div id="sidebar_menr">
        <ul>

        </ul>
    </div>

    <div id="container">

    </div>

    <!--筛选浮层-->
    <div id="screen_box">
        <div class="click" onclick="$(this).parent().fadeOut(200);"></div>
        <div class="screen">
            <div class="condition">
                <p>关键字</p>
                <div class="input">
                    <input id="keyword" type="text"/>
                </div>
            </div>
            <div class="condition">
                <p>当前价格</p>
                <div class="input">
                    <input id="price_1" onkeyup="this.value=this.value.replace(/[^\d]/g,'')"
                           style="width:170px;float:left"
                           type="text"/> ~
                    <input id="price_2" min="100" onkeyup="this.value=this.value.replace(/[^\d]/g,'')"
                           style="width:170px;float:right"
                           type="text"/>
                </div>
            </div>
            <div class="condition">
                <p>一口价</p>
                <div class="input">
                    <input id="price_3" onkeyup="this.value=this.value.replace(/[^\d]/g,'')"
                           style="width:170px;float:left"
                           type="text"/> ~
                    <input id="price_4" min="$('#price_3').val()" onkeyup="this.value=this.value.replace(/[^\d]/g,'')"
                           style="width:170px;float:right" type="text"/>
                </div>
            </div>
            <div class="condition">
                <p>拍品ID</p>
                <div class="input">
                    <input id="productId" type="text"/>
                </div>
            </div>
            <div class="condition">
                <p>卖家昵称</p>
                <div class="input">
                    <input id="sellerName" type="text"/>
                </div>
            </div>

            <div class="bt_box">
                <button onclick="resetCond()">重置</button>
                <button onclick="saveCond()">保存条件</button>
                <button class="seachbt" onclick="search()">搜索</button>
            </div>
            <div class="record_box">
                <div class="title">
                    <p class="state">保存记录</p>
                    <p class="deletebt"><img src="img/index/delete.png"><span>清空</span></p>
                </div>
                <ul>

                </ul>
            </div>

        </div>
    </div>
</div>
<script src="js/template.js" type="text/javascript"></script>
<script src="js/common.js" type="text/javascript"></script>
<script type="text/javascript">

    shareMsg(); //分享


    visiAddRecord('ALL');//访问统计
    getCond();
    $(".search_input").focus(function () {
        console.log(999999);
        window.location.href = "search.html"
    });

    function search() {
        var keyword = $("#keyword").val();
        var currentPriceMin = $("#price_1").val();
        var currentPriceMax = $("#price_2").val();
        var buyoutPriceMin = $("#price_3").val();
        var buyoutPriceMax = $("#price_4").val();
        var auctionId = $("#productId").val();
        var sellerName = $("#sellerName").val();

        if (currentPriceMax < currentPriceMin) {
            hint(hint('请输入正确的价格区间'));
            return false;
        }
        if (buyoutPriceMax < buyoutPriceMin) {
            hint(hint('请输入正确的价格区间'));
            return false;
        }
        window.location.href = "productList.html?keyword=" + keyword + "&currentPriceMin=" + currentPriceMin + "&currentPriceMax=" + currentPriceMax + "&buyoutPriceMin=" + buyoutPriceMin + "&buyoutPriceMax=" + buyoutPriceMax + "&auctionId=" + auctionId + "&sellerName=" + sellerName
    }


    function scroll() {
        var start = -170;
        var list = [];
        var list2 = [];
        var h = start;
        var index = $("#container ul").length;
        for (var i = 1; i <= index; i++) {
            h += $(".part" + i).height();
            list.push(h - Math.floor($(".part" + (i)).height() / 2));
            list2.push(h);
        }
        $(window).scroll(function () {
            var top = $(window).scrollTop();
            for (var i = 0; i < list.length; i++) {
                if (top <= list[0]) {
                    $("#sidebar_menr ul li").removeClass("hover");
                    $("#sidebar_menr ul li").eq(0).addClass("hover");
                } else if (top > list[i] && top <= list[i + 1]) {
                    let f = i + 1;
                    $("#sidebar_menr ul li").removeClass("hover");
                    $("#sidebar_menr ul li").eq(f).addClass("hover");
                }
            }
        });
        $("#sidebar_menr ul li").click(function () {
            var index = $(this).index();
            if (index - 1 < 0) {
                $("html,body").animate({scrollTop: start}, 500);
                return false;
            }
            $("html,body").animate({scrollTop: list2[index - 1] - 100}, 500);
            return false;
        })
    }

    // 获取分类列表
    $.ajax({
        url: link + "/goods/cates",
        type: "GET",
        data: {
            requestId: 'd79b9efa995f',
            timestamp: new Date().getTime(),
        },
        dataType: "Json",
        success: function (res) {
            console.log(res);
            handler({
                res: res, fun1: function () {
                    console.log(res);
                    var parentResult = "";
                    var result = "";
                    for (var i = 0; i < res.data.length; i++) {
                        if (res.data[i].allCate == false) {
                            parentResult += '<li>' + res.data[i].cateName + '</li>';
                            // var m = i+1
                            result += '<ul class="part' + i + '"><p class="title">' + res.data[i].cateName + '</p>';
                            for (var j = 0; j < res.data[i].childList.length; j++) {
                                result += '<li onclick="productList(\'' + res.data[i].childList[j].cateId + '\')">' +
                                    '<img src="' + link + res.data[i].childList[j].cateImg + '" alt="" />' +
                                    '<p>' + res.data[i].childList[j].cateName + '</p>' +
                                    '</li>'
                            }
                            result += '</ul>'
                        }
                    }
//                 				console.log(parentResult);
//                 				console.log(result)
                    $("#sidebar_menr ul").append(parentResult);
                    $("#container").append(result);
                    $("#sidebar_menr ul li:nth-child(1)").addClass("hover");
                    scroll();
                }
            })
        },
        error: function (e) {
        }
    })

</script>
</body>
</html>