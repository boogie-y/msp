<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>草稿箱</title>
    <meta content="width=device-width,target-densitydpi=device-dpi, user-scalable=0" name="viewport"/>
    <meta content="yes" name="apple-mobile-web-app-capable"/>
    <meta content="true" name="HandheldFriendly"/>
    <meta content="yes" name="apple-touch-fullscreen"/>
    <meta content="模型APP内测招募" property="title"/>
    <meta content="最强最走心的模型APP登场！去模型圈大佬面对面交流，晒单拍卖无缝连接。" property="description"/>
    <meta content="最强最走心的模型APP登场！去模型圈大佬面对面交流，晒单拍卖无缝连接。" property="keywords"/>
    <meta content="https://www.2501p.com/img/share_logo.jpg" property="image"/>

    <meta content="模型APP内测招募" property="og:title"/>
    <meta content="最强最走心的模型APP登场！去模型圈大佬面对面交流，晒单拍卖无缝连接。" property="og:description"/>
    <meta content="最强最走心的模型APP登场！去模型圈大佬面对面交流，晒单拍卖无缝连接。" property="og:keywords"/>
    <meta content="https://www.2501p.com/img/share_logo.jpg" property="og:image"/>
    <script type="text/javascript">
        if (/Android (\d+\.\d+)/.test(navigator.userAgent)) {
            var version = parseFloat(RegExp.$1);
            if (version > 2.3) {
                var phoneScale = parseInt(window.screen.width) / 750;
                document.write('<meta name="viewport" content="width=750, minimum-scale = ' + phoneScale + ', maximum-scale = ' + phoneScale + ', target-densitydpi=device-dpi">');
            } else {
                document.write('<meta name="viewport" content="width=, target-densitydpi=device-dpi">');
            }
        } else {
            document.write('<meta name="viewport" content="width=750, user-scalable=no">');
        }
    </script>
    <link href="css/style.css" rel="stylesheet">
    <script src="js/jquery-3.4.1.min.js" type="text/javascript"></script>

    <link href="mescroll/mescroll.min.css" rel="stylesheet">
    <style type="text/css">
        .mescroll {
            position: fixed;
            top: 106px;
            bottom: 0px;
            height: auto;
        }
    </style>
</head>
<body>
<div id="draft">
    <div class="head_nav">
        <ul>
            <li class="hover" data-posttype="POSTS">帖子</li>
            <li data-posttype="TREASURE">藏品</li>
            <li data-posttype="AUCTION">热拍</li>
        </ul>
    </div>

    <div class="content">
        <div class="mescroll" id="mescroll">
            <ul class="detail" id="dataList">
                <!--<li>
                    <p class="title">商品标题</p>
                    <p class="txt">正办正办正办正办正办正办正办正办正办正办正办正办正办正办</p>
                    <div class="img">
                        <img src="img/detail/img.png" alt=""/>
                        <img src="img/detail/img.png" alt=""/>
                        <img src="img/detail/img.png" alt=""/>
                    </div>
                    <div class="button">
                        <button class="detele">删除</button>
                        <button class="compile">编辑</button>
                    </div>
                </li>-->
            </ul>
        </div>
    </div>
</div>

<script src="js/common.js" type="text/javascript"></script>
<script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js"></script>

<!--上拉加载文件-->
<script charset="utf-8" src="mescroll/mescroll.min.js"></script>
<script type="text/javascript">
    shareMsg(); //分享


    var height = $(window).height();
    $("#draft").height(height);

    var postType = 'POSTS';
    $('.head_nav li').click(function () {
        $('.head_nav li').removeClass('hover');
        $(this).addClass('hover');

        postType = $(this).data('posttype');
        mescroll.resetUpScroll();
    });

    // 参数对象
    var paramObject = getParamObject();
    // 创建mescroll对象
    var mescroll = new MeScroll("mescroll", {
        up: {
            callback: upCallback, //上拉回调,此处可简写; 相当于 callback: function (page) { getListData(page); }
            isBounce: false, //此处禁止ios回弹,解析(务必认真阅读,特别是最后一点): http://www.mescroll.com/qa.html#q10
            noMoreSize: 1,
            clearEmptyId: "dataList", //1.下拉刷新时会自动先清空此列表,再加入数据; 2.无任何数据时会在此列表自动提示空
            toTop: { //配置回到顶部按钮
                src: "../res/img/mescroll-totop.png" //默认滚动到1000px显示,可配置offset修改
            }
        }
    });

    //上拉加载的回调 page = {num:1, size:10}; num:当前页 默认从1开始, size:每页数据条数,默认10
    function upCallback(page) {
        paramObject.pageNumber = page.num; // 页码, 默认从1开始 如何修改从0开始 ?
        paramObject.pageSize = page.size; // 页长, 默认每页10条
        paramObject.postType = postType; // 帖子类型
        paramObject.viewType = 'DRAFT'; // 帖子状态
        paramObject.requestId = md5($.param(paramObject)); // 请求ID
        paramObject.timestamp = new Date().getTime(); // 请求时间戳

        getPost('start_time')
    }

    // 设置列表数据
    function setListData(curPageData) {
        var str = "";
        for (var i = 0; i < curPageData.length; i++) {
            var pd = curPageData[i];
            console.log(pd.images);
            str += '<li>' +
                // '<h1 class="title">' + pd.title + '</h1>' +
                '<p class="txt">' + pd.text + '</p>';
            if (pd.images || pd.mainVideo) {
                str += '<div class="img_box">';
                if (pd.mainVideo) {
//							str +='<video src="'+link+pd.mainVideo'"></video>'


//                  str += '<div class="video"><video src="' + link + pd.mainVideo + '" controls preload></video></div>'
                    str += '<div class="img"><img src="img/videoImg.png" alt="" /></div>';

                }
                if (pd.images) {
                    str += initLabelHTML(pd.images)
                }
                str += '</div>'
            }
            str += '<div class="button">' +
                '<button class="detele" onclick="deletePosts(\'' + postType + '\',\'' + pd.postId + '\',this)">删除</button>';
            if (postType == 'POSTS') {
                str += '<button class="compile" onclick="compile(\'' + postType + '\',\'' + pd.postId + '\')">编辑</button>'
            } else {
                str += '<button class="compile" onclick="compile(\'' + postType + '\',\'' + pd.itemId + '\')">编辑</button>'
            }
            str += '</div>' +
                '</li>'
        }
        $("#dataList").append(str);
    }

    // 初始化标签HTML
    function initLabelHTML(tagArray) {
        var tagArray = tagArray.split(";");
        var labelHTML = '';
        for (var i = 0; i < tagArray.length; i++) {
            var imgList = tagArray[i].split('.');
            labelHTML += '<div class="img"><img onload="imgHeight(this)" src="' + link + imgList[0] + '.thumbnail.' + imgList[1] + '" onerror="src=\'img/img_default.png\'" alt="" /></div>';
        }
        return labelHTML;
    }

    function compile(type, postId) {
        switch (type) {
            case 'POSTS':
                window.location.href = "issue_post.html?postId=" + postId;
                break;
            case 'TREASURE':
                window.location.href = "issue_object.html?id=1&postId=" + postId;
                break;
            case 'AUCTION':
                window.location.href = "issue_object.html?id=2&postId=" + postId;
                break;
        }
    }
</script>
<script>
    $(".head_nav li").click(function () {
        $(".head_nav li").removeClass("hover");
        $(this).addClass("hover")
    })
</script>
</body>
</html>