<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>点赞</title>
    <meta content="width=device-width,target-densitydpi=device-dpi, user-scalable=0" name="viewport"/>
    <meta content="yes" name="apple-mobile-web-app-capable"/>
    <meta content="true" name="HandheldFriendly"/>
    <meta content="yes" name="apple-touch-fullscreen"/>
    <meta content="模型APP内测招募" property="title"/>
    <meta content="最强最走心的模型APP登场！去模型圈大佬面对面交流，晒单拍卖无缝连接。" property="description"/>
    <meta content="最强最走心的模型APP登场！去模型圈大佬面对面交流，晒单拍卖无缝连接。" property="keywords"/>
    <meta content="https://www.2501p.com/img/share_logo.jpg" property="image"/>

    <meta content="模型APP内测招募" property="og:title"/>
    <meta content="最强最走心的模型APP登场！去模型圈大佬面对面交流，晒单拍卖无缝连接。" property="og:description"/>
    <meta content="最强最走心的模型APP登场！去模型圈大佬面对面交流，晒单拍卖无缝连接。" property="og:keywords"/>
    <meta content="https://www.2501p.com/img/share_logo.jpg" property="og:image"/>
    <script type="text/javascript">
        if (/Android (\d+\.\d+)/.test(navigator.userAgent)) {
            var version = parseFloat(RegExp.$1);
            if (version > 2.3) {
                var phoneScale = parseInt(window.screen.width) / 750;
                document.write('<meta name="viewport" content="width=750, minimum-scale = ' + phoneScale + ', maximum-scale = ' + phoneScale + ', target-densitydpi=device-dpi">');
            } else {
                document.write('<meta name="viewport" content="width=, target-densitydpi=device-dpi">');
            }
        } else {
            document.write('<meta name="viewport" content="width=750, user-scalable=no">');
        }
    </script>
    <link href="css/style.css" rel="stylesheet">
    <script src="js/jquery-3.4.1.min.js" type="text/javascript"></script>


    <link href="mescroll/mescroll.min.css" rel="stylesheet"></link>
    <style type="text/css">

        /*列表*/
        .mescroll {
            position: fixed;
            top: 122px;
            bottom: 100px;
            width: 100%;
            height: auto;
        }

        /*展示上拉加载的数据列表*/
        .data-list li {
            position: relative;
            /*padding: 10px 8px 10px 120px;*/
            /*border-bottom: 1px solid #eee;*/
        }

        .data-list .pd-img {
            position: absolute;
            left: 18px;
            top: 18px;
            width: 80px;
            height: 80px;
        }

        .data-list .pd-name {
            font-size: 16px;
            line-height: 20px;
            height: 40px;
            overflow: hidden;
        }

        .data-list .pd-price {
            margin-top: 8px;
            color: red;
        }

        .data-list .pd-sold {
            font-size: 12px;
            margin-top: 8px;
            color: gray;
        }
    </style>
</head>
<body>
<div id="plant" style="overflow: hidden;">
    <!-- <div class="head">
        <p class="title"><span>0</span>人觉得很赞</p>
    </div> -->

    <div class="content">
        <ul id="sildeMenu">
            <li class="hover" style="margin-left:83px">我关注的</li>
            <li>普通用户</li>
            <li>V认证</li>
            <li>大V认证</li>
        </ul>

        <div class="mescroll" id="mescroll">
            <!--展示上拉加载的数据列表-->
            <ul class="data-list postdetail" id="dataList">
                <!--
                <li>
                    <div class="head_img"><img src="img/detail/head_img.png"/></div>
                    <p class="user_nam">胖田大叔</p>
                    <div class="Authentication"><img src="img/myhome/Authentication.png"></div>
                </li>-->
                <!--
                <li>
                    <p class="title">帖子标题</p>
                    <p class="describe">正品手办正品手办正品手办正品手办正品手办正品手办=正品手办正品手办正品手办正品手办...</p>
                    <div class="img_big"><img src="img/association/img2.png"></div>
                    <div class="bt_box">
                        <div class="quanzi">
                            <p>圈子</p>
                        </div>
                        <div class="lable">
                            <p>#标签</p>
                        </div>
                    </div>
                    <div class="operation">
                        <p class="conment">999</p>
                        <p class="like">999</p>
                    </div>
                </li>-->
            </ul>
        </div>
    </div>
</div>

<script src="js/common.js" type="text/javascript"></script>
<script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js"></script>
<!--上拉加载文件-->
<script charset="utf-8" src="mescroll/mescroll.min.js"></script>
<script type="text/javascript">

    shareMsg(); //分享

    $(".content").css({"min-height": $(window).height() - 88});
    var postId = getQueryStringByName('postId');

    var userLevel = '';
    var viewType = 'FOLLOWS';
    var index = '';
    $("#sildeMenu li").click(function () {
        $("#sildeMenu li").removeClass("hover");
        $(this).addClass("hover");
        index = $(this).index();
        if (index - 1 >= 0) {
            console.log(index - 1);
            viewType = 'ISGOOD';
            userLevel = index - 1;
            console.log(viewType)
        } else {
            viewType = 'FOLLOWS'
        }
        mescroll.resetUpScroll();
    });


    // 参数对象

    var mescroll = new MeScroll("mescroll", {
        up: {
            callback: upCallback, //上拉回调,此处可简写; 相当于 callback: function (page, mescroll) { getListData(page); }
            isBounce: false, //此处禁止ios回弹,解析(务必认真阅读,特别是最后一点): http://www.mescroll.com/qa.html#q10
            noMoreSize: 1,
            clearEmptyId: "dataList", //相当于同时设置了clearId和empty.warpId; 简化写法;默认null; 注意vue中不能配置此项
            lazyLoad: {
                use: true // 是否开启懒加载,默认false
            },
            toTop: { //配置回到顶部按钮
                src: "../res/img/mescroll-totop.png" //默认滚动到1000px显示,可配置offset修改
            }
        }
    });


    var paramObject = getParamObject();

    //上拉加载的回调 page = {num:1, size:10}; num:当前页 默认从1开始, size:每页数据条数,默认10
    function upCallback(page) {
        paramObject.pageNumber = page.num; // 页码, 默认从1开始 如何修改从0开始 ?
        paramObject.pageSize = page.size; // 页长, 默认每页10条
        paramObject.requestId = md5($.param(paramObject)); // 请求ID
        paramObject.timestamp = new Date().getTime(); // 请求时间戳
        paramObject.postId = postId; // 帖子Id
        paramObject.viewType = viewType; // FOLLOWS我关注的人点赞， ISGOOD其他点赞人
        if (viewType == 'ISGOOD') {
            paramObject.userLevel = userLevel; // 用户等级
        }
        $.ajax({
            url: link + "/social/postcollect/getUserListIsGood?" + $.param(paramObject),
            dataType: "Json",
            success: function (res) {
                console.log(res);
                handler({
                    res: res,
                    fun1: function () {
                        var curPageData = res.data; // 接口返回的当前页数据列表
                        var totalSize = res.count; // 接口返回的总数据量(比如列表有26个数据,每页10条,共3页; 则totalSize值为26)
                        mescroll.endBySize(curPageData.length, totalSize); // 联网成功的回调,隐藏下拉刷新和上拉加载的状态;
                        setListData(curPageData); // 设置列表数据
                        $("title").text(res.count + '人觉得很赞')
                    }
                })
            },
            error: function (e) {
                mescroll.endErr()
            }
        });
    }

    // 设置列表数据
    function setListData(curPageData) {
        var str = "";
        for (var i = 0; i < curPageData.length; i++) {
            var pd = curPageData[i];
            str += '<li onclick="window.location.href=\'myHome.html?userId=' + pd.userId + '\'">' +
                '<div class="head_img">' + headImgHtml(pd.avatarPath) + '</div>' +
                '<div class="msg"><p class="user_nam">' + userName(pd.username) + '</p>';
            if (pd.userLevel == 1) {
                str += '<div class="Authentication"><img src="img/myhome/v_1.png"></div>'
            } else if (pd.userLevel == 2) {
                str += '<div class="Authentication"><img src="img/myhome/v_2.png"></div>'
            }
            str += '<div class="attention" data-userid="' + pd.userId + '" data-isFollow="" ><span>访问</span></div></div>';
            str += '</li>'

        }
        $("#dataList").append(str);
    }

    // 初始化标签HTML
    function initLabelHTML(tagArray) {
        var labelHTML = '';
        for (var i = 0; i < tagArray.length; i++) {
            labelHTML += '<p>#' + tagArray[i] + '</p>';
        }
        return labelHTML;
    }
</script>

<script>


    $("#menu ul li").click(function () {
        $("#menu ul li").removeClass("current");
        $(this).addClass("current");
    });

    $(".morebt").click(function () {
        if ($(".moreMenu").hasClass("dis"))
            $(".moreMenu").removeClass("dis");
        else
            $(".moreMenu").addClass("dis")
    })
</script>
</body>
</html>