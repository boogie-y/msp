<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta content="true" name="HandheldFriendly">
    <meta content="yes" name="apple-touch-fullscreen">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta content="width=device-width,target-densitydpi=device-dpi, user-scalable=0" name="viewport">
    <title>物流详情</title>
    <link href="css/style.css" rel="stylesheet">

    <meta content="模型APP内测招募" property="title"/>
    <meta content="最强最走心的模型APP登场！去模型圈大佬面对面交流，晒单拍卖无缝连接。" property="description"/>
    <meta content="最强最走心的模型APP登场！去模型圈大佬面对面交流，晒单拍卖无缝连接。" property="keywords"/>
    <meta content="https://www.2501p.com/img/share_logo.jpg" property="image"/>

    <meta content="模型APP内测招募" property="og:title"/>
    <meta content="最强最走心的模型APP登场！去模型圈大佬面对面交流，晒单拍卖无缝连接。" property="og:description"/>
    <meta content="最强最走心的模型APP登场！去模型圈大佬面对面交流，晒单拍卖无缝连接。" property="og:keywords"/>
    <meta content="https://www.2501p.com/img/share_logo.jpg" property="og:image"/>

    <script type="text/javascript">
        if (/Android (\d+\.\d+)/.test(navigator.userAgent)) {
            const version = parseFloat(RegExp.$1);
            if (version > 2.3) {
                const phoneScale = window.screen.width / 750;
                document.write('<meta name="viewport" content="width=750, minimum-scale = ' + phoneScale + ', maximum-scale = ' + phoneScale + ', target-densitydpi=device-dpi">');
            } else {
                document.write('<meta name="viewport" content="width=, target-densitydpi=device-dpi">');
            }
        } else {
            document.write('<meta name="viewport" content="width=750, user-scalable=no">');
        }
    </script>
    <script src="js/jquery-3.4.1.min.js" type="text/javascript"></script>
</head>

<body>
<div id="logisticsDetail">
    <div id="content">
        <div class="productMsg">
            <!-- <div class="img"><img src="img/index/img.png" alt=""/></div>
            <div class="msg">
                <p class="state">物流状态：<span></span></p>
                <p class="conpany">承运来源：<span></span></p>
                <p class="number">运单编号：<span></span></p>
                <p class="tel">官方电话：<span></span></p>
            </div> -->
        </div>

        <div class="detailMsg">
            <p class="title">物流追踪</p>
            <ul>
                <!-- <li>
                    <div class="img"><img src="img/order/delivery-status1.png"></div>
                    <div class="detail">
                        <p class="addr">已经抵达上海市</p>
                        <p class="time">2019-05-12 ：21:26:35</p>
                    </div>
                </li>
                <li>
                    <div class="img"><img src="img/order/delivery-status2.png"></div>
                    <div class="detail">
                        <p class="addr">已经抵达上海市</p>
                        <p class="time">2019-05-12 ：21:26:35</p>
                    </div>
                </li> -->
            </ul>
        </div>

    </div>
</div>

<script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js" type="text/javascript"></script>
<script src="js/common.js" type="text/javascript"></script>
<script type="text/javascript">
    shareMsg(); //分享


    let STATE_INFO = ['在途', '揽收', '疑难', '签收', '退签', '派件', '退回', '转投'];
    let orderId = getQueryStringByName("orderId");
    let logisticsData;
    //获取物流信息
    $.ajax({
        url: link + '/system/companies/' + orderId,
        type: 'GET',
        data: {
            requestId: md5(orderId),
            timestamp: new Date().getTime()
        }
    }).done(function (response) {
        console.log(response);

        handler({
            res: response,
            fun1: function () {
                logisticsData = response.data;

                setProductMsgHTML();

                setDetailMsgHTML();
            }
        })
    });

    function setProductMsgHTML() {
        let productMsgHTML = '';
        productMsgHTML += '<div class="img">';
        productMsgHTML += '    <img src="' + (logisticsData.images ? link + logisticsData.images.split(';')[0] : 'img/img.png') + '" alt="">';
        productMsgHTML += '</div>';
        productMsgHTML += '<div class="msg">';
        productMsgHTML += '    <p class="state">物流状态：<span>' + STATE_INFO[parseInt(logisticsData.state)] + '</span></p>';
        productMsgHTML += '    <p class="conpany">承运来源：<span>' + logisticsData['company'] + '</span></p>';
        productMsgHTML += '    <p class="number">运单编号：<span>' + logisticsData.number + '</span></p>';
        productMsgHTML += '    <p class="tel">官方电话：<span>' + logisticsData.mobile + '</span></p>';
        productMsgHTML += '</div>';
        $('.productMsg').html(productMsgHTML);
    }

    function setDetailMsgHTML() {
        let detailMsgHTML = '';

        let list = logisticsData.list;
        for (let i = 0; i < list.length; i++) {
            let imageName = i === 0 ? 'status1' : 'status2';

            detailMsgHTML += '<li>';
            detailMsgHTML += '    <div class="img"><img src="img/order/delivery-' + imageName + '.png" alt=""></div>';
            detailMsgHTML += '    <div class="detail">';
            detailMsgHTML += '        <p class="addr">' + list[i].context + '</p>';
            detailMsgHTML += '        <p class="time">' + list[i].time + '</p>';
            detailMsgHTML += '    </div>';
            detailMsgHTML += '</li>';
        }
        $('.detailMsg ul').html(detailMsgHTML);
    }
</script>
</body>

</html>
