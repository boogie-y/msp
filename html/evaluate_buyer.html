<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>评价买家</title>
    <meta content="true" name="HandheldFriendly">
    <meta content="yes" name="apple-touch-fullscreen">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta content="width=device-width,target-densitydpi=device-dpi, user-scalable=0" name="viewport">
    <link href="css/style.css" rel="stylesheet">
    <meta content="模型APP内测招募" property="title"/>
    <meta content="最强最走心的模型APP登场！去模型圈大佬面对面交流，晒单拍卖无缝连接。" property="description"/>
    <meta content="最强最走心的模型APP登场！去模型圈大佬面对面交流，晒单拍卖无缝连接。" property="keywords"/>
    <meta content="https://www.2501p.com/img/share_logo.jpg" property="image"/>

    <meta content="模型APP内测招募" property="og:title"/>
    <meta content="最强最走心的模型APP登场！去模型圈大佬面对面交流，晒单拍卖无缝连接。" property="og:description"/>
    <meta content="最强最走心的模型APP登场！去模型圈大佬面对面交流，晒单拍卖无缝连接。" property="og:keywords"/>
    <meta content="https://www.2501p.com/img/share_logo.jpg" property="og:image"/>
    <style type="text/css">
        .main {
            width: 100%;
            margin: auto;
        }

        .btn {
            width: 680px;
            height: 88px;
            background: url("img/order/bt_bg.png");
            border-radius: 8px;
            overflow: hidden;
            border: none;
            font-size: 30px;
            color: white;
            margin-top: 80px;
        }

        .upimg input {
            position: absolute;
            width: 100px;
            height: 100px;
            opacity: 0;
        }

        #showui li {
            width: 223px;
            height: 223px;
            position: relative;
            overflow: hidden;
            display: inline-block;
            margin-right: 5px;
            float: left
        }

        .showdiv img {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }
    </style>

    <script type="text/javascript">
        if (/Android (\d+\.\d+)/.test(navigator.userAgent)) {
            const version = parseFloat(RegExp.$1);
            if (version > 2.3) {
                const phoneScale = window.screen.width / 750;
                document.write('<meta name="viewport" content="width=750, minimum-scale = ' + phoneScale + ', maximum-scale = ' + phoneScale + ', target-densitydpi=device-dpi">');
            } else {
                document.write('<meta name="viewport" content="width=, target-densitydpi=device-dpi">');
            }
        } else {
            document.write('<meta name="viewport" content="width=750, user-scalable=no">');
        }
    </script>
    <script src="js/jquery-3.4.1.min.js" type="text/javascript"></script>
</head>

<body>
<div id="mark">
    <div id="content">

        <div class="score_box">
            <p class="title">您对此次交易的评价是？</p>
            <ul>
                <li class="grade1"><p>好评</p></li>
                <li class="grade2"><p>中评</p></li>
                <li class="grade3"><p>差评</p></li>
            </ul>
        </div>

        <div class="mark_box">
            <div class="main">
                <button class="btn" onclick="submitComments();">提交评论</button>
            </div>
        </div>

        <div class="hint_box" style="top: 200px; bottom: 0;">
            <p></p>
        </div>

    </div>
</div>

<script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js" type="text/javascript"></script>
<script src="js/common.js" type="text/javascript"></script>
<script src="js/updateimg.js" type="text/javascript"></script>
<script type="text/javascript">
    shareMsg(); //分享


    let EVALUATE_LEVEL = ['PRAISE', 'AVERAGE', 'NEGATIVE'];
    let orderId = getQueryStringByName("orderId");
    let ajaxData = new FormData();
    /**
     * 切换评价等级
     */
    $('.score_box').on('click', 'li', function () {
        $('.score_box li').removeClass('hover');
        $(this).addClass('hover');
    });

    /**
     * 提交评论
     */
    function submitComments() {
        let index = $('.score_box .hover').index();
        if (-1 === index) hint('请选择评价等级');

        ajaxData.append('level', EVALUATE_LEVEL[index]);

        const objData = {};
        ajaxData.forEach((value, key) = > objData[key] = value;
    )
        ajaxData.append('requestId', md5(JSON.stringify(objData)));
        ajaxData.append('timestamp', new Date().getTime() + '');
        $.ajax({
            url: link + '/order/orders/' + orderId + '/evaluate',
            type: 'POST',
            data: ajaxData,
            processData: false,
            contentType: false
        }).done(function (response) {
            console.log(response);

            handler({
                res: response,
                fun1: function () {
                    history.back();
                }
            })
        })
    }
</script>
</body>

</html>
